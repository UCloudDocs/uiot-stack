# 固件升级概述


物联网设备上线发布之后，设备的功能的修改或者bug的修复可依靠远程升级进行。IoT平台提供在线升级功能(OTA)，可以方便用户对设备进行进行在线升级。



## 功能说明

**固件模块**

同一设备可能存在多个功能模块需要进行固件升级，为了满足此类设备升级需求。IoT平台的提供固件模块来区分设备不同功能模块的升级需求。

**固件**

设备升级所使用的固件，IoT平台提供固件的版本管理。

**升级任务**

IoT平台提供按照升级批次创建升级任务，方便实际操作时按照设备固件版本或设备状态进行批次升级并追溯不同批次任务的升级信息及对应设备的升级状态。

**固件版本分布**

IoT平台提供单一模块下设备的固件版本分布统计。



## 升级状态及升级流程说明

**升级状态**

创建升级任务后设备的升级状态如下

<->:设备未创建过升级任务

<待推送>：创建升级任务时设备不在线。设备在线后需上报当前版本，平台校验设备当前版本和升级任务的原版本一致后下发升级任务

<已推送>：已向设备推送升级任务信息并获取设备响应

<升级中>：设备上报升级中

<升级成功>：设备上报升级成功

<升级失败>：设备上报升级失败

<已取消>：平台取消升级任务

**升级流程**

![图片](../../images/固件升级-13.png)

**升级状态对应操作**

创建升级任务：当升级状态为<-><升级成功><已取消>时可创建升级任务

重试升级：当升级状态为<待推送><已推送><升级中><升级失败>时可重试，重试为当前任务重新执行一次

取消升级：当升级状态为<待推送><已推送><升级中><升级失败>时可取消任务
取消任务后：
1、待推送设备不再推送升级信息；已推送设备不做任何操作
2、设备升级状态改为<已取消>，如设备后续上报升级状态则按照最新状态更新